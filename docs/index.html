<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç„¼ãã‚“ã—ã‚ƒã„éå…¬å¼</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Noto Sans JP', sans-serif; background-color: #f0f2f5; color: #1f2937; }
        .card { background: white; border-radius: 16px; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1); }
        
        /* ã‚«ãƒ†ã‚´ãƒªãƒ¼åˆ¥ã®ã‚¢ã‚¯ã‚»ãƒ³ãƒˆã‚«ãƒ©ãƒ¼ */
        .theme-single_star { border-top: 8px solid #3b82f6; } 
        .theme-double_star { border-top: 8px solid #f97316; } 
        .theme-triple_star { border-top: 8px solid #ef4444; }
        .theme-portion { border-top: 8px solid #10b981; } 
        
        .step-bubble {
            background: #f8fafc;
            border-left: 6px solid #3b82f6;
            transition: transform 0.1s;
        }
        .step-bubble:active { transform: scale(0.98); }

        .portion-row { border-bottom: 1px inset #f1f5f9; padding: 12px 0; }
        .portion-row:last-child { border-bottom: none; }
    </style>
</head>
<body class="p-4 pb-12">

<div id="app" class="max-w-md mx-auto">
    
    <header class="flex items-center justify-between mb-6">
        <button id="global-back-btn" class="hidden p-2 bg-white rounded-full shadow text-gray-600 active:bg-gray-200">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
            </svg>
        </button>
        <h1 id="app-title" class="text-2xl font-black text-gray-800 mx-auto">ã‚­ãƒƒãƒãƒ³ãƒ¡ãƒ¢</h1>
    </header>

    <div id="difficulty-select" class="grid gap-3">
        <button onclick="selectCategory('single_star')" class="p-5 card border-b-4 border-blue-500 text-xl font-bold text-blue-700 flex justify-between items-center">
            ğŸŸ åˆºã—å ´ <span class="text-xs bg-blue-100 px-2 py-1 rounded">æ‰‹é †</span>
        </button>
        <button onclick="selectCategory('double_star')" class="p-5 card border-b-4 border-orange-500 text-xl font-bold text-orange-700 flex justify-between items-center">
            ğŸŸ æšã’å ´ <span class="text-xs bg-orange-100 px-2 py-1 rounded">æ‰‹é †</span>
        </button>
        <button onclick="selectCategory('triple_star')" class="p-5 card border-b-4 border-red-500 text-xl font-bold text-red-700 flex justify-between items-center">
            ğŸ”¥ ç„¼ãå ´ <span class="text-xs bg-red-100 px-2 py-1 rounded">ã‚¯ã‚¤ã‚º</span>
        </button>
        <button onclick="selectCategory('portion')" class="p-5 card border-b-4 border-green-500 text-xl font-bold text-green-700 flex justify-between items-center">
            âš–ï¸ ãƒãƒ¼ã‚·ãƒ§ãƒ³ <span class="text-xs bg-green-100 px-2 py-1 rounded">ä»•è¾¼ã¿é‡</span>
        </button>
    </div>

    <div id="menu-list-screen" class="hidden">
        <h2 id="menu-list-heading" class="text-xl font-bold mb-4 px-2 text-gray-700"></h2>
        <div id="menu-options-area" class="grid gap-2"></div>
    </div>

    <div id="procedure-screen" class="hidden">
        <div class="card p-5 theme-default border-t-8" id="procedure-card">
            <h3 id="procedure-name" class="text-2xl font-black mb-4 border-b pb-2 text-center"></h3>
            <div id="procedure-content-area" class="space-y-3"></div>
            <button onclick="handleBack()" class="mt-8 w-full py-4 bg-gray-800 text-white rounded-xl font-bold">ãƒªã‚¹ãƒˆã«æˆ»ã‚‹</button>
        </div>
    </div>

    <div id="quiz-screen" class="hidden">
        <div class="card p-5 border-t-8 border-red-500">
            <div class="text-center mb-4">
                <span class="text-sm font-bold text-red-500 uppercase tracking-widest">å‘³ä»˜ã‘ã‚¯ã‚¤ã‚º</span>
                <h3 id="quiz-item-name" class="text-3xl font-black"></h3>
            </div>
            <div id="quiz-choices-area" class="grid gap-3"></div>
            <div id="quiz-feedback" class="mt-4 p-4 rounded-lg text-center font-bold hidden"></div>
            <button id="next-from-quiz-btn" onclick="handleBack()" class="mt-6 w-full py-4 bg-red-500 text-white rounded-xl font-bold hidden">å®Œäº†ã—ã¦æ¬¡ã¸</button>
        </div>
    </div>

    <div id="portion-screen" class="hidden">
        <div class="card p-5 theme-portion border-t-8">
            <h3 id="portion-title" class="text-2xl font-black mb-4 border-b pb-2 text-center text-green-700"></h3>
            <div id="portion-list-area" class="space-y-1"></div>
            <button onclick="handleBack()" class="mt-8 w-full py-4 bg-gray-800 text-white rounded-xl font-bold">ãƒªã‚¹ãƒˆã«æˆ»ã‚‹</button>
        </div>
    </div>

</div>

<script>
    const quizzes = [
        // --- åˆºã—å ´ æ‰‹é † ---
        { "difficulty": "single_star", "name": "æè±†", "type": "multiple_choice", "answer": '500W 2åˆ† çš¿ã«ç››ã‚Šä»˜ã‘ã¦å¡©ã‚’ãµã‚‹' },
        { "difficulty": "single_star", "name": "ãŸã“ã‚ã•", "type": "multiple_choice", "answer": 'åŠåˆ†ã«ã—ãŸå¤§è‘‰ ãŸã“ã‚ã•(40g)ã‚’ç››ã‚Šä»˜ã‘' },
        { "difficulty": "single_star", "name": "æ¢…ã‚¯ãƒ©ã‚²", "type": "multiple_choice", "answer": 'åŠåˆ†ã«ã—ãŸå¤§è‘‰ æ¢…ã‚¯ãƒ©ã‚²(30g)ã‚’ç››ã‚Šä»˜ã‘' },
        { "difficulty": "single_star", "name": "ãƒãƒ£ãƒ³ã‚¸ãƒ£", "type": "multiple_choice", "answer": 'åŠåˆ†ã«ã—ãŸå¤§è‘‰ ãƒãƒ£ãƒ³ã‚¸ãƒ£(30g)ã‚’ç››ã‚Šä»˜ã‘ã€ãƒã‚®ã€†' },
        { "difficulty": "single_star", "name": "çš®ã½ã‚“/è’¸ã—é¶ã½ã‚“", "type": "reordering", "steps": ['å¤§è‘‰ã‚’æ•·ã', 'ã‚ªãƒ‹ã‚¹ãƒ©', 'é¶çš®/è’¸ã—é¶ç››ã‚Šã¤ã‘', 'ãƒã‚®ã€å¤§æ ¹ãŠã‚ã—','ãƒãƒ³é…¢'] },
        { "difficulty": "single_star", "name": "ãˆã®ãã½ã‚“", "type": "reordering", "steps": ['ãˆã®ã600w40ç§’ã‹500w50ç§’ã ãï¼ğŸ¤“', 'ãƒã‚®ã€å¤§æ ¹ãŠã‚ã—','ãƒãƒ³é…¢'] },
        { "difficulty": "single_star", "name": "ç„¡é™ãƒ”ãƒ¼ãƒãƒ³", "type": "multiple_choice", "answer": 'ã”ã¾æ²¹ã€å¡©ã€å¡©æ˜†å¸ƒã€ç™½ã”ã¾' },
        { "difficulty": "single_star", "name": "æ¼¬ç‰©ç››åˆã›", "type": "multiple_choice", "answer": 'ãŸãã‚ã‚“30gã€ã‹ã£ã±30gã€ã—ã°æ¼¬ã‘30g' },
        { "difficulty": "single_star", "name": "é•·èŠ‹ã‚ã•ã³", "type": "multiple_choice", "answer": 'å™¨ã«é•·ã„ã‚‚ã‚’80gç››ã‚Šã€åˆ»ã¿ã®ã‚Šã€†' },
        { "difficulty": "single_star", "name": "ãŸãŸããã‚…ã†ã‚Š", "type": "reordering", "steps": ['çš¿ã«ãŸãŸããã‚…ã†ã‚Šã‚’ç››ã‚‹', 'ã—ãŠã ã‚Œã‚’ã‹ã‘ã‚‹', 'ã‚´ãƒã€†'] },
        { "difficulty": "single_star", "name": "ã¨ã‚Šã®ãŸãŸã", "type": "reordering", "steps": ['å™¨ã«ã‚ªãƒ‹ã‚¹ãƒ©ã‚’ç››ã‚‹','å¤§è‘‰ã‚’ä¹—ã›ã‚‹','ãŸãŸã4æš', 'å°çš¿ã«ãƒã‚®ã€ã—ã‚‡ã†ãŒ'] },
        { "difficulty": "single_star", "name": "é¶ã‚ã•ã³å’Œãˆ", "type": "reordering", "steps": ['çš¿ã«å¤§è‘‰ã‚’ä¹—ã›ã‚‹','ã‚ªãƒ‹ã‚¹ãƒ©ã‚’ç››ã‚‹' , 'ãƒ¦ãƒƒã‚±60Gã‚ã•ã³ã¨é†¤æ²¹æ··ãœã¦ç››ã‚Šä»˜ã‘','ã®ã‚Š'] },
        { "difficulty": "single_star", "name": "é¶æ¢…è‚‰å’Œãˆ", "type": "reordering", "steps": ['çš¿ã«å¤§è‘‰ã‚’ä¹—ã›ã‚‹','ã‚ªãƒ‹ã‚¹ãƒ©ã‚’ç››ã‚‹' , 'ãƒ¦ãƒƒã‚±60Gæ¢…è‚‰ã‚’æ··ãœã¦ç››ã‚Šä»˜ã‘ã‚‹','ã®ã‚Š'] },
        { "difficulty": "single_star", "name": "é¶ãƒ¦ãƒƒã‚±", "type": "reordering", "steps": ['çš¿ã«å¤§è‘‰ã‚’ä¹—ã›ã‚‹','ã‚ªãƒ‹ã‚¹ãƒ©ã‚’ç››ã‚‹' , 'ãƒ¦ãƒƒã‚±60gç››ã‚‹', 'ãƒ¦ãƒƒã‚±ã‚¿ãƒ¬ã‚’ã‹ã‘ã‚‹','ç”Ÿã†ãšã‚‰','ãƒã‚®ã¨ç™½ã”ã¾'] },
        { "difficulty": "single_star", "name": "é¶å¡©ãƒ¦ãƒƒã‚±", "type": "reordering", "steps": ['çš¿ã«å¤§è‘‰ã‚’ä¹—ã›ã‚‹','ã‚ªãƒ‹ã‚¹ãƒ©ã‚’ç››ã‚‹' , 'ãƒ¦ãƒƒã‚±60gç››ã‚‹', 'å¡©ã ã‚Œã‚’ã‹ã‘ã‚‹','ç”Ÿã†ãšã‚‰','ãƒã‚®ã¨ç™½ã”ã¾'] },
        { "difficulty": "single_star", "name": "ç‚™ã‚Šã—ã‚ã•ã°", "type": "multiple_choice", "answer": 'è§£å‡ã—ãŸé¯–ã«åˆ‡ã‚Œç›®ã‚’å…¥ã‚Œ8ç­‰åˆ† ç‚™ã£ã¦ã‚ªãƒ‹ã‚¹ãƒ©å¤§è‘‰ã«ç››ã‚Šä»˜ã‘ ã‚ã•ã³' },
        { "difficulty": "single_star", "name": "å‡ºæ±å·»ããŸã¾ã”", "type": "multiple_choice", "answer": '600W 4åˆ† ç¬¹è‘‰ã®ä¸Šã«ç››ã‚Šä»˜ã‘ã¦ ãŠã‚ã—å¤§æ ¹ ã€†' },
        { "difficulty": "single_star", "name": "è’¸ã—é¶ã‚µãƒ©ãƒ€", "type": "multiple_choice", "answer": 'ã‚µãƒ©ãƒ€ãƒ™ãƒ¼ã‚¹ã«è’¸ã—é¶1ãƒãƒ¼ã‚·ãƒ§ãƒ³ èƒ¡éº»ãƒ‰ãƒ¬ãƒƒã‚·ãƒ³ã‚°ã€†' },
        { "difficulty": "single_star", "name": "è±†è…ã¨å¡©æ˜†å¸ƒã®ã‚µãƒ©ãƒ€", "type": "multiple_choice", "answer": 'ã‚µãƒ©ãƒ€ãƒ™ãƒ¼ã‚¹ã«4ç­‰åˆ†ã®è±†è…ã¨å¡©æ˜†å¸ƒ å’Œé¢¨ãƒ‰ãƒ¬ãƒƒã‚·ãƒ³ã‚°ã€ã‹ã¤ãŠç¯€ã€†' },
        { "difficulty": "single_star", "name": "æ¸©ç‰ã‚·ãƒ¼ã‚¶ãƒ¼ã‚µãƒ©ãƒ€", "type": "multiple_choice", "answer": 'ã‚µãƒ©ãƒ€ãƒ™ãƒ¼ã‚¹ã«æ¸©ç‰ï¼‘å€‹ã€ã‚¯ãƒ«ãƒˆãƒ³ã€ç²‰ãƒãƒ¼ã‚ºã‹ã‘ã¦ ã‚·ãƒ¼ã‚¶ãƒ¼ãƒ‰ãƒ¬ãƒƒã‚·ãƒ³ã‚°ã€†' },

        // --- æšã’å ´ æ‰‹é † ---
        { "difficulty": "double_star", "name": "ãƒãƒ†ãƒˆãƒ•ãƒ©ã‚¤", "type": "multiple_choice", "answer": "2åˆ†30ç§’é–“æšã’ã‚‹ å¡©ãµã‚Šã‹ã‘ã€ã‚±ãƒãƒ£ãƒƒãƒ—" },
        { "difficulty": "double_star", "name": "ã•ã¤ã¾ãƒã‚¿ãƒ¼", "type": "multiple_choice", "answer": '4åˆ†é–“æšã’ã‚‹ ãƒã‚¿ãƒ¼ ãƒãƒãƒŸãƒ„ã¨ãƒ‘ã‚»ãƒª' },
        { "difficulty": "double_star", "name": "ã‚‚ã‚ã“ã—å”æšã’", "type": "multiple_choice", "answer": '3åˆ†é–“æšã’ã‚‹ å¡©ãµã‚Šã‹ã‘ ãƒ‘ã‚»ãƒª' },
        { "difficulty": "double_star", "name": "åå¤å±‹é¢¨æ‰‹ç¾½å…ˆå”æšã’", "type": "multiple_choice", "answer": 'ç‰‡æ —ç²‰5åˆ†é–“æšã’ã‚‹ ã‚­ãƒ£ãƒ™ãƒ„ã®ä¸Šã«ç››ã‚Šä»˜ã‘ã¦æ‰‹ç¾½ã‚¿ãƒ¬ã€ã‚³ã‚·ãƒ§ã‚¦ã€ç™½ã”ã¾' },
        { "difficulty": "double_star", "name": "ãªã‚“ã“ã¤å”æšã’", "type": "multiple_choice", "answer": "å”æšã’ç²‰2åˆ†é–“æšã’ã‚‹ ãƒ¬ãƒ¢ãƒ³" },
        { "difficulty": "double_star", "name": "ã‹ã‚ãƒ‘ãƒª", "type": "multiple_choice", "answer": "ç‰‡æ —ç²‰+å”æšã’ç²‰2åˆ†é–“æšã’ã‚‹ ãƒ¬ãƒ¢ãƒ³" },
        { "difficulty": "double_star", "name": "ã˜ã‚ƒã“å¤©", "type": "multiple_choice", "answer": "ä¸¡é¢3åˆ†é–“æšã’ã‚‹ å¤©ç´™ã®ä¸Šã«ï¼–ç­‰åˆ†ã—ã¦ãƒã‚®ã€ã—ã‚‡ã†ãŒ" },
        { "difficulty": "double_star", "name": "è‹¥é¶ã®ã‹ã‚‰ã‚ã’", "type": "multiple_choice", "answer": "ç‰‡æ —ç²‰5åˆ†é–“æšã’ã‚‹ ã‚µãƒ©ãƒ€ã®ä¸Šã«ç››ã‚Šä»˜ã‘ ãƒ¬ãƒ¢ãƒ³ã€ãƒãƒ¨ãƒãƒ¼ã‚º" },
        { "difficulty": "double_star", "name": "ãƒã‚­ãƒ³å—è›®", "type": "multiple_choice", "answer": "5åˆ†é–“æšã’ã‚‹ 4ç­‰åˆ†ã«ã—ã¦ã‚µãƒ©ãƒ€ã®ä¸Šã«ç››ã‚Šä»˜ã‘ã€ã‚¿ãƒ«ã‚¿ãƒ« å—è›®é…¢ ãƒ¬ãƒ¢ãƒ³ã€ãƒ‘ã‚»ãƒª" },

        // --- ç„¼ãå ´ ã‚¯ã‚¤ã‚º ---
        { "difficulty": "triple_star", "name": "ãƒ¬ã‚¿ã‚¹å·»ã", "answer": 'å¡©ã‚³ã‚·ãƒ§ã‚¦', "dummies": ['ã‚¿ãƒ¬', 'ãƒãƒ³é…¢','æ¢…è‚‰','ãƒã‚¸ãƒ«','æ˜å¤ªãƒãƒ¨'] },
        { "difficulty": "triple_star", "name": "ãƒ¤ãƒ³ã‚³ãƒ³å·»ã", "answer": 'å¡©ã‚³ã‚·ãƒ§ã‚¦', "dummies": ['ã‚¿ãƒ¬', 'ãƒãƒ³é…¢','æ¢…è‚‰','ãƒã‚¸ãƒ«','æ˜å¤ªãƒãƒ¨'] },
        { "difficulty": "triple_star", "name": "ãˆã®ãå·»ã", "answer": 'ãƒãƒ³é…¢', "dummies": ['å¡©ã‚³ã‚·ãƒ§ã‚¦', 'ã‚¿ãƒ¬','æ¢…è‚‰','ãƒã‚¸ãƒ«','æ˜å¤ªãƒãƒ¨'] },
        { "difficulty": "triple_star", "name": "ã†ãšã‚‰å·»ã", "answer": 'ã‚¿ãƒ¬', "dummies": ['å¡©ã‚³ã‚·ãƒ§ã‚¦','ãƒãƒ³é…¢','æ¢…è‚‰','ãƒã‚¸ãƒ«','æ˜å¤ªãƒãƒ¨'] },
        { "difficulty": "triple_star", "name": "å¤§è‘‰å·»ã", "answer": 'æ¢…è‚‰', "dummies": ['å¡©ã‚³ã‚·ãƒ§ã‚¦', 'ã‚¿ãƒ¬', 'ãƒãƒ³é…¢','ãƒã‚¸ãƒ«','æ˜å¤ªãƒãƒ¨'] },
        { "difficulty": "triple_star", "name": "ã‚¢ã‚¹ãƒ‘ãƒ©å·»ã", "answer": 'å¡©ã‚³ã‚·ãƒ§ã‚¦', "dummies": ['ã‚¿ãƒ¬', 'ãƒãƒ³é…¢','æ¢…è‚‰','ãƒã‚¸ãƒ«','æ˜å¤ªãƒãƒ¨'] },
        { "difficulty": "triple_star", "name": "ãƒˆãƒãƒˆãƒãƒ¼ã‚ºå·»ã", "answer": 'ãƒã‚¸ãƒ«', "dummies": ['å¡©ã‚³ã‚·ãƒ§ã‚¦', 'ã‚¿ãƒ¬', 'ãƒãƒ³é…¢','æ¢…è‚‰','æ˜å¤ªãƒãƒ¨'] },
        { "difficulty": "triple_star", "name": "ãªã™ãƒãƒ¼ã‚ºå·»ã", "answer": 'ã‚¿ãƒ¬', "dummies": ['å¡©ã‚³ã‚·ãƒ§ã‚¦','ãƒãƒ³é…¢','æ¢…è‚‰','ãƒã‚¸ãƒ«','æ˜å¤ªãƒãƒ¨'] },
        { "difficulty": "triple_star", "name": "ç™½ãƒã‚®å·»ã", "answer": 'ã‚¿ãƒ¬', "dummies": ['å¡©ã‚³ã‚·ãƒ§ã‚¦','ãƒãƒ³é…¢','æ¢…è‚‰','ãƒã‚¸ãƒ«','æ˜å¤ªãƒãƒ¨'] },
        { "difficulty": "triple_star", "name": "ãˆã³ã®è‚‰å·»ã", "answer": 'å¡©ã‚³ã‚·ãƒ§ã‚¦', "dummies": ['ã‚¿ãƒ¬', 'ãƒãƒ³é…¢','æ¢…è‚‰','ãƒã‚¸ãƒ«','æ˜å¤ªãƒãƒ¨'] },
        { "difficulty": "triple_star", "name": "ãƒ¢ãƒƒãƒ„ã‚¡ãƒ¬ãƒ©ãƒãƒ¼ã‚ºå·»ã", "answer": 'å¡©ã‚³ã‚·ãƒ§ã‚¦', "dummies": ['ã‚¿ãƒ¬','ãƒãƒ³é…¢','æ¢…è‚‰','ãƒã‚¸ãƒ«','æ˜å¤ªãƒãƒ¨'] },
        { "difficulty": "triple_star", "name": "é•·èŠ‹æ˜å¤ªãƒãƒ¨å·»ã", "answer": 'æ˜å¤ªãƒãƒ¨', "dummies": ['å¡©ã‚³ã‚·ãƒ§ã‚¦', 'ã‚¿ãƒ¬', 'ãƒãƒ³é…¢','æ¢…è‚‰','ãƒã‚¸ãƒ«'] },

        // --- ãƒãƒ¼ã‚·ãƒ§ãƒ³ãƒ‡ãƒ¼ã‚¿ (è¿½åŠ åˆ†) ---
        { "difficulty": "portion", "name": "åˆºã—å ´ãƒ»é‡èœ", "data": [
            { "item": "ãƒ”ãƒ¼ãƒãƒ³", "amount": "40", "unit": "g" },
            { "item": "ãã‚…ã†ã‚Š", "amount": "85-90", "unit": "g" },
            { "item": "æè±†", "amount": "100", "unit": "g" },
            { "item": "ãˆã®ã½ã‚“", "amount": "60", "unit": "g" },
            { "item": "è’¸ã—é¶", "amount": "50", "unit": "g" }
        ]},
        { "difficulty": "portion", "name": "æšã’å ´ãƒ»ä¸€å“", "data": [
            
            { "item": "è§’ç…®", "amount": "90/3", "unit": "g/å€‹" },
            { "item": "ãƒãƒ†ãƒˆãƒ•ãƒ©ã‚¤", "amount": "150", "unit": "g" },
            { "item": "æ‰‹ç¾½å…ˆ", "amount": "3", "unit": "å€‹" },
            { "item": "ã¨ã†ã‚‚ã‚ã“ã—", "amount": "3", "unit": "å€‹" },
            { "item": "è»Ÿéª¨å”æšã’", "amount": "100", "unit": "g" },
            { "item": "ã‹ã‚ã±ã‚Š", "amount": "100", "unit": "g" },
            { "item": "é‡ŒèŠ‹", "amount": "8", "unit": "å€‹" },
            { "item": "ã‚¦ã‚¤ãƒ³ãƒŠãƒ¼", "amount": "6", "unit": "å€‹" }
        ]},
        { "difficulty": "portion", "name": "ç„¼ãå ´ãƒ»è‚‰", "data": [
            { "item": "ã‚¨ã‚¤ãƒ’ãƒ¬", "amount": "30", "unit": "g" },
            { "item": "ç„¼ããŠã«ãã‚Š", "amount": "160", "unit": "g" },
            { "item": "ã‚µã‚¶ã‚¨", "amount": "2", "unit": "å€‹" },
            { "item": "ãƒ›ã‚¿ãƒ†", "amount": "1", "unit": "å€‹" },
            { "item": "ãƒ›ãƒ«ãƒ¢ãƒ³", "amount": "150", "unit": "g" },
            { "item": "ã¤ãã­", "amount": "50", "unit": "g" }
        ]},
        { "difficulty": "portion", "name": "é‡œé£¯ãƒ»é›‘ç‚Šãƒ»èª¿å‘³æ–™", "data": [
            { "item": "æµ¸æ°´ç±³", "amount": "200", "unit": "g" },
            { "item": "é›‘ç‚Šãƒ»é‡œé£¯ é¶è‚‰", "amount": "50", "unit": "g" },
            { "item": "é‡œé‡èœ(ã‚ã’ãƒ»ã‚´ãƒœã‚¦)", "amount": "å„10", "unit": "g" },
            { "item": "é›‘ç‚Šã‚¨ãƒã‚­", "amount": "15", "unit": "g" },
            { "item": "èµ¤å‘³å™Œ", "amount": "90", "unit": "g" },
            { "item": "ç™½å‘³å™Œ(ãƒ‹ãƒ³ãƒ‹ã‚¯5gãƒã‚¿ãƒ¼2å€‹)", "amount": "90g", "unit": "g" },
            { "item": "å‡çµæœå®Ÿ", "amount": "40", "unit": "g" }
        ]}
    ];

    let currentDifficulty = '';

    function showScreen(screenId) {
        ['difficulty-select', 'menu-list-screen', 'procedure-screen', 'quiz-screen', 'portion-screen'].forEach(id => {
            const el = document.getElementById(id);
            if (el) el.classList.toggle('hidden', id !== screenId);
        });
        document.getElementById('global-back-btn').classList.toggle('hidden', screenId === 'difficulty-select');
    }

    function selectCategory(diff) {
        currentDifficulty = diff;
        renderMenuList();
    }

    function handleBack() {
        const current = getCurrentScreen();
        if (['procedure-screen', 'quiz-screen', 'portion-screen'].includes(current)) {
            renderMenuList();
        } else {
            showScreen('difficulty-select');
        }
    }

    function getCurrentScreen() {
        if (!document.getElementById('portion-screen').classList.contains('hidden')) return 'portion-screen';
        if (!document.getElementById('procedure-screen').classList.contains('hidden')) return 'procedure-screen';
        if (!document.getElementById('quiz-screen').classList.contains('hidden')) return 'quiz-screen';
        if (!document.getElementById('menu-list-screen').classList.contains('hidden')) return 'menu-list-screen';
        return 'difficulty-select';
    }

    function renderMenuList() {
        const area = document.getElementById('menu-options-area');
        area.innerHTML = '';
        const filtered = quizzes.filter(q => q.difficulty === currentDifficulty);
        const names = { 'single_star': 'åˆºã—å ´', 'double_star': 'æšã’å ´', 'triple_star': 'ç„¼ãå ´', 'portion': 'ãƒãƒ¼ã‚·ãƒ§ãƒ³' };
        document.getElementById('menu-list-heading').textContent = `ã€${names[currentDifficulty]}ã€‘é¸æŠ`;

        filtered.forEach(quiz => {
            const btn = document.createElement('button');
            btn.className = 'w-full text-left p-4 card hover:bg-gray-50 flex justify-between items-center font-bold text-gray-700 active:bg-gray-100 transition-colors';
            btn.innerHTML = `${quiz.name} <span class="text-gray-400 font-normal">â–¶ï¸</span>`;
            
            btn.onclick = () => {
                if (currentDifficulty === 'portion') showPortion(quiz);
                else if (currentDifficulty === 'triple_star') startQuiz(quiz);
                else showProcedure(quiz);
            };
            area.appendChild(btn);
        });
        showScreen('menu-list-screen');
    }

    function showProcedure(quiz) {
        const card = document.getElementById('procedure-card');
        card.className = `card p-5 theme-${quiz.difficulty} border-t-8`;
        document.getElementById('procedure-name').textContent = quiz.name;
        const contentArea = document.getElementById('procedure-content-area');
        contentArea.innerHTML = '';

        if (quiz.type === 'multiple_choice') {
            contentArea.innerHTML = `<div class="p-6 bg-blue-50 text-blue-800 text-xl font-bold rounded-xl text-center shadow-inner border border-blue-200">${quiz.answer}</div>`;
        } else {
            quiz.steps.forEach((step, i) => {
                contentArea.innerHTML += `<div class="step-bubble p-4 rounded-xl flex gap-3 items-center">
                    <span class="bg-blue-500 text-white w-8 h-8 rounded-full flex items-center justify-center shrink-0 font-bold">${i+1}</span>
                    <span class="text-lg font-bold text-gray-800">${step}</span>
                </div>`;
            });
        }
        showScreen('procedure-screen');
    }

    function showPortion(quiz) {
        document.getElementById('portion-title').textContent = quiz.name;
        const area = document.getElementById('portion-list-area');
        area.innerHTML = '';

        quiz.data.forEach(d => {
            area.innerHTML += `
                <div class="portion-row flex justify-between items-center">
                    <span class="text-lg font-bold text-gray-600">${d.item}</span>
                    <div class="flex items-baseline">
                        <span class="text-3xl font-black text-green-600">${d.amount}</span>
                        <span class="text-sm font-bold text-gray-400 ml-1">${d.unit}</span>
                    </div>
                </div>`;
        });
        showScreen('portion-screen');
    }

    function startQuiz(quiz) {
        document.getElementById('quiz-item-name').textContent = quiz.name;
        const area = document.getElementById('quiz-choices-area');
        const feedback = document.getElementById('quiz-feedback');
        const nextBtn = document.getElementById('next-from-quiz-btn');
        area.innerHTML = ''; feedback.classList.add('hidden'); nextBtn.classList.add('hidden');

        const choices = [quiz.answer, ...quiz.dummies].sort(() => Math.random() - 0.5);
        choices.forEach(choice => {
            const btn = document.createElement('button');
            btn.className = 'w-full p-4 card border-2 border-gray-100 text-lg font-bold active:bg-gray-100 transition-all';
            btn.textContent = choice;
            btn.onclick = () => {
                const isCorrect = choice === quiz.answer;
                if (isCorrect) {
                    btn.classList.add('border-green-500', 'bg-green-50', 'text-green-700');
                    feedback.textContent = "æ­£è§£ã§ã™ï¼";
                    feedback.className = "mt-4 p-4 rounded-lg text-center font-bold bg-green-100 text-green-700";
                    nextBtn.classList.remove('hidden');
                    Array.from(area.children).forEach(b => b.disabled = true);
                } else {
                    btn.classList.add('border-red-500', 'bg-red-50', 'text-red-700');
                    feedback.innerHTML = `é•ã„ã¾ã™ï¼<br><span class="text-sm font-normal text-red-500">æ­£è§£ã¯ã€${quiz.answer}ã€‘</span>`;
                    feedback.className = "mt-4 p-4 rounded-lg text-center font-bold bg-red-100 text-red-700";
                }
                feedback.classList.remove('hidden');
            };
            area.appendChild(btn);
        });
        showScreen('quiz-screen');
    }

    document.getElementById('global-back-btn').onclick = handleBack;
</script>
</body>
</html>











